<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
  html, body {
    margin: 0;
    padding: 0;
    background: radial-gradient(circle at top, #11142a, #05060f);
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .wheel-container {
    position: relative;
    width: 92vmin;
    max-width: 720px;
    filter: drop-shadow(0 0 40px rgba(0,0,0,0.9));
  }

  canvas {
    width: 100%;
    height: auto;
    border-radius: 50%;
    background: white;
  }

  .pointer {
    position: absolute;
    top: -14px;
    left: 50%;
    transform: translateX(-50%);
    width: 0;
    height: 0;
    border-left: 26px solid transparent;
    border-right: 26px solid transparent;
    border-bottom: 48px solid #ff3b3b;
    filter: drop-shadow(0 0 14px rgba(255,59,59,0.9));
    z-index: 10;
  }
</style>
</head>

<body>

<div class="wheel-container">
  <div class="pointer"></div>
  <canvas id="wheel" width="700" height="700"></canvas>
</div>

<audio id="spinSound" src="https://assets.mixkit.co/sfx/preview/mixkit-fast-rocket-whoosh-1714.mp3"></audio>

<script>
const canvas = document.getElementById("wheel");
const ctx = canvas.getContext("2d");
const spinSound = document.getElementById("spinSound");

// Full set: 1â€“25 (ALL EXIST)
const numbers = Array.from({ length: 25 }, (_, i) => i + 1);

// These exist visually but NEVER win
const banned = new Set([3, 11, 19, 25, 20, 22, 18]);

const sliceAngle = (2 * Math.PI) / numbers.length;

const colors = [
  "#ff5252","#ff4081","#e040fb","#7c4dff",
  "#536dfe","#448aff","#40c4ff","#18ffff",
  "#64ffda","#69f0ae","#b2ff59","#eeff41",
  "#ffd740","#ffab40","#ff6e40"
];

let angle = 0;
let spinning = false;

function drawWheel() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  numbers.forEach((num, i) => {
    const start = angle + i * sliceAngle;
    const end = start + sliceAngle;

    ctx.beginPath();
    ctx.moveTo(350, 350);
    ctx.arc(350, 350, 350, start, end);
    ctx.fillStyle = colors[i % colors.length];
    ctx.fill();
    ctx.strokeStyle = "#ffffff";
    ctx.stroke();

    ctx.save();
    ctx.translate(350, 350);
    ctx.rotate(start + sliceAngle / 2);
    ctx.textAlign = "right";
    ctx.fillStyle = "#ffffff";
    ctx.font = "bold 30px Arial";
    ctx.fillText(num, 320, 12);
    ctx.restore();
  });
}

drawWheel();

canvas.addEventListener("click", () => {
  if (spinning) return;
  spinning = true;

  spinSound.currentTime = 0;
  spinSound.play();

  // ðŸŽ¯ Pick a winning number that is NOT banned
  const allowedIndexes = numbers
    .map((n, i) => banned.has(n) ? null : i)
    .filter(i => i !== null);

  const winningIndex =
    allowedIndexes[Math.floor(Math.random() * allowedIndexes.length)];

  // Angle math to land EXACTLY on the chosen slice
  const targetAngle =
    (Math.PI * 3 / 2) - (winningIndex * sliceAngle + sliceAngle / 2);

  const extraSpins = 6 * 2 * Math.PI;
  const startAngle = angle;
  const finalAngle = targetAngle + extraSpins;
  const duration = 4200;
  const startTime = performance.now();

  function animate(time) {
    const progress = Math.min((time - startTime) / duration, 1);
    const ease = 1 - Math.pow(1 - progress, 3);

    angle = startAngle + (finalAngle - startAngle) * ease;
    drawWheel();

    if (progress < 1) {
      requestAnimationFrame(animate);
    } else {
      angle = finalAngle;
      spinning = false;
    }
  }

  requestAnimationFrame(animate);
});
</script>

</body>
</html>